<!DOCTYPE html>
<html lang="es">
<head>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>STOP DESPACHOS</title>
  <!-- Agregar los archivos CSS de Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <h1>NO M√ÅS DESPACHOS DEL CT</h1>
    <p>Pongamos fin a los despachos de CT gracias esta revolucionaria herramienta</p>
    <br>

    <div class="row">
      <div class="col-md-6">
        <label for="summoner" class="form-label">Summoner</label>
        <input type="text" class="form-control" id="summoner" placeholder="Summoner">
      </div>
      <div class="col-md-6">
        <label for="tag" class="form-label">Tag</label>
        <input type="text" class="form-control" id="tag" placeholder="Tag">
      </div>
    </div>
    <br>
    <button class="btn btn-primary" onclick="consultarAPI()">¬øCuantas rankeds hay registradas?</button>
    <p id="resultado" class="mt-3"></p>

    <i>Powered by W2A. Expertos en Frontend desde 2024</i>
    <br>
    <br>
    <br>
    <i>Disclaimer:</i> La consulta es pasada a una Raspberry (un ordenador xikitito) que hay en mi casa, para posteriormente preguntarle a RIOT. Los datos que pasan son: tu IP y el nombre de la cuenta que buscas. Los datos no se guardan (he quitado el <i>print</i>), pero ah√≠ te tienes que fiar de mi palabra.
  </div>

  <!-- Agregar los archivos JavaScript de Bootstrap (opcional, solo si necesitas funcionalidades espec√≠ficas de Bootstrap) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    process.env["NODE_TLS_REJECT_UNAUTHORIZED"] = 0;
    function consultarAPI() {
      const summoner = document.getElementById('summoner').value;
      const tag = document.getElementById('tag').value.replace("#", "");
      const url = `https://stopdespachosapi.latragallucci.dev:8080/games/?summoner=${encodeURIComponent(summoner)}&tag=${encodeURIComponent(tag)}`;
      document.getElementById('resultado').innerText = `Consultando los archivos...`;

      fetch(url)
        .then(response => {
          if (!response.ok) {
            throw new Error('Algo hemos roto. Perd√≥n üò£');
          }
          return response.json();
        })
        .then(data => {
          document.getElementById('resultado').innerText = `Hemos contado hasta: ${data} partidas desde el 1 de Enero de 2022`;
        })
        .catch(error => {
          console.error('Error:', error);
          document.getElementById('resultado').innerText = '¬øSeguro que el nick est√° bien puesto? Quiz√°s somos nosotros, pero... Nose, revisa.';
        });
    }
  </script>
</body>
</html>